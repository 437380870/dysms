# 服务地址 {#concept_yfq_qg1_hgb .concept}

短信服务统一使用以下公网服务地址：

|功能|域名|
|:-|:-|
|发送短信|dysmsapi.aliyuncs.com|
|消息接收1|dybaseapi.aliyuncs.com|
|消息接收2|http\(s\)://1943695596114318.mns.cn-hangzhou.aliyuncs.com|

## 专有网络（VPC） {#section_rhk_kj1_hgb .section}

如果您的服务器类型不是阿里云ECS服务器、或者是阿里云经典网络类型的服务器，则需要使用公网访问服务。服务地址如下：

如果您的服务器类型为专有网络（VPC）下的ECS，则可以通过内网请求接口。

**说明：** 

-   仅支持华东1、华东2、华北2、华南1的专有网络下ECS通过内网访问。
-   短信发送接口必须通过POST的数据提交方式 和 JSON的数据交互格式才可以使用。
-   消息接收2的地址不支持HTTPS。
-   接口中RegionID必须正确填写为ECS所在地域。
-   需要使用云通信消息接收的用户还需要将队列的地域修改为与ECS相同的地域。

    操作步骤：

    1.  登录短信服务控制台。
    2.  单击**系统设置** \> **通用设置** \> **。**
    3.  开启**状态报告接收**。
    4.  单击**设置地域**。

        相同地域内的产品内网可以互通，建议所选地域与您部署的服务器地域一致，若不一致，您将会通过公网获取信息。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/84974/154753908135586_zh-CN.png)


|网络类型|地域|功能|
|发送短信|接收消息1|接收消息2|
|:---|:-|:-|
|:---|:----|:----|
|公网（默认、推荐）|dysmsapi.aliyuncs.com|dybaseapi.aliyuncs.com|http\(s\)://1943695596114318.mns.cn-hangzhou.aliyuncs.com|
|专有网络（VPC）|华东1（ cn-hangzhou）|dysmsapi-vpc.cn-hangzhou.aliyuncs.com|dybaseapi-vpc.cn-hangzhou.aliyuncs.com|http://1943695596114318.mns.cn-hangzhou-internal-vpc.aliyuncs.com|
|华东2 （cn-shanghai）|dysmsapi-vpc.cn-shanghai.aliyuncs.com|dybaseapi-vpc.cn-shanghai.aliyuncs.com|http://1943695596114318.mns.cn-shanghai-internal-vpc.aliyuncs.com|
|华北2（cn-beijing）|dysmsapi-vpc.cn-beijing.aliyuncs.com|dybaseapi-vpc.cn-beijing.aliyuncs.com|http://1943695596114318.mns.cn-beijing-internal-vpc.aliyuncs.com|
|华南1（cn-shenzhen）|dysmsapi-vpc.cn-shenzhen.aliyuncs.com|dybaseapi-vpc.cn-shenzhen.aliyuncs.com|http://1943695596114318.mns.cn-shenzhen-internal-vpc.aliyuncs.com|

## 切换网络类型 {#section_e24_lh1_hgb .section}

如果您之前使用的是公网地址，需要改为VPC地址时，请参考以下方案处理。

-   **SDK用户**：
    1.  修改SDK示例中的domain。
    2.  修改SDK示例中的提交方式和交互格式。

        java发送示例修改如下：

        1.  发送短信：

            ```
            ...
            import com.aliyuncs.http.FormatType;
            import com.aliyuncs.http.MethodType;
            ...
            final String domain = "dysmsapi-vpc.cn-hangzhou.aliyuncs.com";//指定对应地域的"短信发送"用的域名，默认公网是dysmsapi.aliyuncs.com"; 
            ...
            DefaultProfile.addEndpoint("cn-hangzhou", "cn-hangzhou", product, domain);//指定与ECS相同的地域
            ...
            SendSmsRequest request = new SendSmsRequest();
            #修改数据提交方式
            request.setMethod(MethodType.POST);
            #修改数据交互格式
            request.setAcceptFormat(FormatType.JSON);
            ```

        2.  消息回执：

            ```
            DefaultAlicomMessagePuller puller=new DefaultAlicomMessagePuller();
            String accessKeyId="yourAccessKeyId";
            String accessKeySecret="yourAccessKeySecret";
            String messageType="SmsReport";//短信回执：SmsReport，短信上行：SmsUp
            String queueName="yourQueueName";//在云通信页面开通相应业务消息后，就能在页面上获得对应的queueName
            String regionIdForPop = "cn-hangzhou";//指定与ECS相同的地域
            String endpointNameForPop = "cn-hangzhou";//指定与ECS相同的地域
            String domainForPop = "dybaseapi-vpc.cn-hangzhou.aliyuncs.com";//指定对应地域的"消息接收1"用的域名
            String mnsAccountEndpoint = "http://1943695596114318.mns.cn-hangzhou-internal-vpc.aliyuncs.com";//指定对应地域的"消息接收2"用的域名
             puller.startReceiveMsgForVPC(accessKeyId,accessKeySecret ,messageType,queueName , regionIdForPop , endpointNameForPop , domainForPop , mnsAccountEndpoint,  new MyMessageListener());
            ```

-   **直接使用HTTP封装**：
    1.  修改或核对系统参数中的数据格式为JSON。

        ```
        paras.put("Format", "JSON");
        ```

    2.  修改或核对业务参数中RegionId与所在地域相同。

        ```
        paras.put("RegionId", "cn-hangzhou");
        ```

    3.  修改或核对请求域名与对照表中的域名相同。
    4.  计算Signature中的HTTPMethod改成POST。
    5.  修改提交方式为POST。

